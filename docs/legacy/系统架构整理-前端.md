# Twitterè‡ªåŠ¨å‘å¸ƒç³»ç»Ÿ - æ¶æ„æ•´ç†æ–‡æ¡£

## 1. ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

### 1.1 ç«¯å£é…ç½®
- **8080ç«¯å£**: åç«¯APIæœåŠ¡ + å‰ç«¯é™æ€æ–‡ä»¶æœåŠ¡ï¼ˆç»Ÿä¸€æœåŠ¡ï¼‰
- **æ²¡æœ‰å…¶ä»–ç«¯å£**: å½“å‰ç³»ç»Ÿåªä½¿ç”¨ä¸€ä¸ªç«¯å£

### 1.2 æ¶æ„æ¨¡å¼
```
æµè§ˆå™¨ â†’ http://localhost:8080 â†’ FastAPIæœåŠ¡å™¨ (API: 8050)
                                    â”œâ”€â”€ é™æ€æ–‡ä»¶æœåŠ¡ (å‰ç«¯)
                                    â””â”€â”€ APIè·¯ç”± (/api/*)
```

## 2. å‰ç«¯æ¶æ„

### 2.1 æ–‡ä»¶ç»“æ„
```
frontend/
â”œâ”€â”€ index.html          # ä¸»é¡µé¢
â””â”€â”€ js/
    â”œâ”€â”€ api.js          # APIå®¢æˆ·ç«¯
    â”œâ”€â”€ app.js          # ä¸»åº”ç”¨é€»è¾‘
    â””â”€â”€ components/
        â”œâ”€â”€ dashboard.js    # ä»ªè¡¨æ¿ç»„ä»¶
        â”œâ”€â”€ tasks.js       # ä»»åŠ¡ç®¡ç†ç»„ä»¶
        â””â”€â”€ projects.js    # é¡¹ç›®ç®¡ç†ç»„ä»¶
```

### 2.2 å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: åŸç”ŸJavaScript + Alpine.js
- **æ ·å¼**: Tailwind CSS
- **APIé€šä¿¡**: Fetch API
- **è®¤è¯**: API Key (X-API-Key header)

### 2.3 APIå®¢æˆ·ç«¯é…ç½®
```javascript
class APIClient {
    constructor() {
        this.baseURL = '/api';  // ç›¸å¯¹è·¯å¾„ï¼ŒåŒåŸŸè¯·æ±‚
        this.apiKey = 'dev-api-key-12345';  // å¼€å‘ç¯å¢ƒå¯†é’¥
    }
}
```

## 3. åç«¯æ¶æ„

### 3.1 æ–‡ä»¶ç»“æ„
```
api/
â”œâ”€â”€ main.py             # FastAPIä¸»åº”ç”¨
â”œâ”€â”€ dependencies.py     # ä¾èµ–æ³¨å…¥
â”œâ”€â”€ middleware.py       # ä¸­é—´ä»¶
â”œâ”€â”€ schemas.py          # æ•°æ®æ¨¡å‹
â””â”€â”€ routers/
    â”œâ”€â”€ auth.py         # è®¤è¯è·¯ç”±
    â”œâ”€â”€ dashboard.py    # ä»ªè¡¨æ¿è·¯ç”±
    â”œâ”€â”€ tasks.py        # ä»»åŠ¡ç®¡ç†è·¯ç”±
    â””â”€â”€ projects.py     # é¡¹ç›®ç®¡ç†è·¯ç”±
```

### 3.2 åç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: FastAPI
- **æ•°æ®åº“**: SQLite + SQLAlchemy ORM
- **è®¤è¯**: API Keyè®¤è¯
- **æ–‡æ¡£**: è‡ªåŠ¨ç”Ÿæˆ OpenAPI/Swagger

### 3.3 APIè·¯ç”±ç»“æ„
```
/api/
â”œâ”€â”€ /auth/*             # è®¤è¯ç›¸å…³
â”œâ”€â”€ /dashboard/*        # ä»ªè¡¨æ¿æ•°æ®
â”œâ”€â”€ /tasks/*           # ä»»åŠ¡ç®¡ç†
â””â”€â”€ /projects/*        # é¡¹ç›®ç®¡ç†
```

## 4. æ•°æ®åº“æ¶æ„

### 4.1 æ•°æ®åº“é…ç½®
- **ç±»å‹**: SQLite
- **ä½ç½®**: `/data/twitter_publisher.db`
- **ç®¡ç†**: DatabaseManagerç±»

### 4.2 æ•°æ®è¡¨ç»“æ„
```sql
-- ç”¨æˆ·è¡¨
users (
    id, username, email, role, api_key, created_at, updated_at
)

-- é¡¹ç›®è¡¨
projects (
    id, user_id, name, description, config, status, created_at, updated_at
)

-- å†…å®¹æºè¡¨
content_sources (
    id, project_id, name, type, config, status, created_at, updated_at
)

-- å‘å¸ƒä»»åŠ¡è¡¨
publishing_tasks (
    id, user_id, project_id, content_source_id, title, content, 
    media_urls, scheduled_time, status, created_at, updated_at
)

-- å‘å¸ƒæ—¥å¿—è¡¨
publishing_logs (
    id, task_id, user_id, status, message, published_at, created_at
)

-- åˆ†ææ•°æ®è¡¨
analytics_hourly (
    id, user_id, project_id, hour, published_count, success_count, 
    error_count, created_at
)

-- APIå¯†é’¥è¡¨
api_keys (
    id, user_id, key_name, api_key, permissions, status, created_at
)
```

### 4.3 å½“å‰æ•°æ®çŠ¶æ€
```
ç”¨æˆ·æ•°é‡: 2 (testuser, admin)
é¡¹ç›®æ•°é‡: 1
å†…å®¹æºæ•°é‡: 1
ä»»åŠ¡æ•°é‡: 0
æ—¥å¿—æ•°é‡: 0
åˆ†ææ•°æ®: 0
```

## 5. APIå®ç°è¯¦æƒ…

### 5.1 è®¤è¯æœºåˆ¶
```python
# APIå¯†é’¥è®¤è¯
async def api_key_auth(x_api_key: str = Header(..., alias="X-API-Key")):
    # éªŒè¯å¯†é’¥: dev-api-key-12345 (å¼€å‘ç¯å¢ƒ)
    # è¿”å›ç”¨æˆ·ID: 1 (é»˜è®¤ç”¨æˆ·)
```

### 5.2 ä¸»è¦APIç«¯ç‚¹

#### ä»ªè¡¨æ¿API
```
GET /api/dashboard/stats        # è·å–ç»Ÿè®¡ä¿¡æ¯
GET /api/dashboard/health       # ç³»ç»Ÿå¥åº·çŠ¶æ€
GET /api/dashboard/recent-activity  # æœ€è¿‘æ´»åŠ¨
GET /api/dashboard/quick-stats  # å¿«é€Ÿç»Ÿè®¡
```

#### ä»»åŠ¡ç®¡ç†API
```
GET    /api/tasks              # è·å–ä»»åŠ¡åˆ—è¡¨
POST   /api/tasks              # åˆ›å»ºä»»åŠ¡
GET    /api/tasks/{id}         # è·å–ä»»åŠ¡è¯¦æƒ…
PUT    /api/tasks/{id}         # æ›´æ–°ä»»åŠ¡
DELETE /api/tasks/{id}         # åˆ é™¤ä»»åŠ¡
POST   /api/tasks/{id}/execute # æ‰§è¡Œä»»åŠ¡
POST   /api/tasks/{id}/cancel  # å–æ¶ˆä»»åŠ¡
```

#### é¡¹ç›®ç®¡ç†API
```
GET    /api/projects           # è·å–é¡¹ç›®åˆ—è¡¨
POST   /api/projects           # åˆ›å»ºé¡¹ç›®
GET    /api/projects/{id}      # è·å–é¡¹ç›®è¯¦æƒ…
PUT    /api/projects/{id}      # æ›´æ–°é¡¹ç›®
DELETE /api/projects/{id}      # åˆ é™¤é¡¹ç›®
```

## 6. æ ¸å¿ƒä¸šåŠ¡é€»è¾‘

### 6.1 åº”ç”¨æ ¸å¿ƒæ¨¡å—
```
app/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ content_generator.py   # å†…å®¹ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ project_manager.py     # é¡¹ç›®ç®¡ç†å™¨
â”‚   â”œâ”€â”€ publisher.py           # å‘å¸ƒå™¨
â”‚   â””â”€â”€ task_scheduler.py      # ä»»åŠ¡è°ƒåº¦å™¨
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ database.py            # æ•°æ®åº“ç®¡ç†
â”‚   â”œâ”€â”€ models.py              # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ repository.py          # æ•°æ®ä»“åº“
â””â”€â”€ utils/
    â”œâ”€â”€ config.py              # é…ç½®ç®¡ç†
    â”œâ”€â”€ logger.py              # æ—¥å¿—ç®¡ç†
    â””â”€â”€ file_handler.py        # æ–‡ä»¶å¤„ç†
```

### 6.2 æ•°æ®æµç¨‹
```
1. ç”¨æˆ·é€šè¿‡å‰ç«¯åˆ›å»ºé¡¹ç›®å’Œå†…å®¹æº
2. ç³»ç»Ÿæ ¹æ®å†…å®¹æºç”Ÿæˆå‘å¸ƒä»»åŠ¡
3. ä»»åŠ¡è°ƒåº¦å™¨æŒ‰æ—¶é—´æ‰§è¡Œä»»åŠ¡
4. å‘å¸ƒå™¨å°†å†…å®¹å‘å¸ƒåˆ°Twitter
5. è®°å½•å‘å¸ƒæ—¥å¿—å’Œåˆ†ææ•°æ®
6. å‰ç«¯å±•ç¤ºç»Ÿè®¡ä¿¡æ¯å’ŒçŠ¶æ€
```

## 7. éƒ¨ç½²å’Œè¿è¡Œ

### 7.1 å¯åŠ¨å‘½ä»¤
```bash
# å¯åŠ¨åç«¯APIæœåŠ¡ï¼ˆåŒ…å«å‰ç«¯ï¼‰
python -m uvicorn api.main:app --host 0.0.0.0 --port 8050 --reload

# è®¿é—®åœ°å€
å‰ç«¯ç•Œé¢: http://localhost:8080
APIæ–‡æ¡£: http://localhost:8050/api/docs
```

### 7.2 ç¯å¢ƒé…ç½®
```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# ç¯å¢ƒå˜é‡
API_API_KEY=dev-api-key-12345
API_DEBUG=true
```

## 8. å½“å‰é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### 8.1 å·²è§£å†³é—®é¢˜
- âœ… é™æ€æ–‡ä»¶è·¯å¾„é”™è¯¯ â†’ ä¿®å¤äº†APIä¸»æ–‡ä»¶ä¸­çš„è·¯å¾„é…ç½®
- âœ… APIå¯†é’¥ä¸åŒ¹é… â†’ ç»Ÿä¸€ä½¿ç”¨ `dev-api-key-12345`

### 8.2 å¾…ä¼˜åŒ–é¡¹ç›®
- ğŸ”„ æ•°æ®åº“ä¸­ç¼ºå°‘æµ‹è¯•æ•°æ® â†’ éœ€è¦åˆ›å»ºç¤ºä¾‹é¡¹ç›®å’Œä»»åŠ¡
- ğŸ”„ å‰ç«¯é”™è¯¯å¤„ç† â†’ éœ€è¦æ”¹è¿›APIè°ƒç”¨å¤±è´¥çš„å¤„ç†
- ğŸ”„ è®¤è¯æœºåˆ¶ â†’ å¯ä»¥è€ƒè™‘JWTæˆ–OAuth2
- ğŸ”„ æ€§èƒ½ä¼˜åŒ– â†’ æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–å’Œç¼“å­˜

## 9. å¼€å‘å»ºè®®

### 9.1 ä»£ç è´¨é‡
- æ·»åŠ æ›´å¤šå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- å®ç°APIå“åº”ç¼“å­˜
- æ·»åŠ æ•°æ®éªŒè¯å’Œé”™è¯¯å¤„ç†

### 9.2 åŠŸèƒ½å¢å¼º
- å®ç°å®æ—¶é€šçŸ¥åŠŸèƒ½
- æ·»åŠ æ•°æ®å¯¼å‡ºåŠŸèƒ½
- æ”¯æŒå¤šå¹³å°å‘å¸ƒï¼ˆä¸ä»…é™äºTwitterï¼‰

### 9.3 å®‰å…¨æ€§
- å®ç°æ›´å®‰å…¨çš„è®¤è¯æœºåˆ¶
- æ·»åŠ APIè®¿é—®é¢‘ç‡é™åˆ¶
- æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨

---

**æ€»ç»“**: å½“å‰ç³»ç»Ÿé‡‡ç”¨å•ç«¯å£æ¶æ„ï¼Œåç«¯FastAPIåŒæ—¶æä¾›APIæœåŠ¡å’Œé™æ€æ–‡ä»¶æœåŠ¡ï¼Œå‰ç«¯é€šè¿‡ç›¸å¯¹è·¯å¾„è°ƒç”¨APIï¼Œä½¿ç”¨APIå¯†é’¥è¿›è¡Œè®¤è¯ã€‚ç³»ç»Ÿç»“æ„æ¸…æ™°ï¼Œä½†éœ€è¦æ·»åŠ æ›´å¤šæµ‹è¯•æ•°æ®å’Œæ”¹è¿›é”™è¯¯å¤„ç†ã€‚