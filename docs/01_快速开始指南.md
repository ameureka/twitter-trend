# 快速开始指南

## 🚀 安装部署

### 系统要求

- **Python**: 3.8 或更高版本
- **内存**: 最少 512MB RAM
- **存储**: 最少 1GB 可用空间
- **网络**: 稳定的互联网连接

### 方式一：Docker部署（推荐）

```bash
# 1. 克隆项目
git clone <repository-url>
cd twitter-trend

# 2. 配置环境变量
cp .env.example .env
# 编辑 .env 文件，填入你的API密钥

# 3. 启动服务
docker-compose up -d

# 4. 验证部署
curl http://localhost:8050/api/health
```

### 方式二：本地安装

```bash
# 1. 克隆项目
git clone <repository-url>
cd twitter-trend

# 2. 创建虚拟环境
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 3. 安装依赖
pip install -r requirements.txt

# 4. 配置环境
cp .env.example .env
# 编辑配置文件

# 5. 验证配置
python scripts/start.py validate

# 6. 启动服务
python scripts/start.py api
```

## ⚙️ 配置指南

### 环境变量配置

创建 `.env` 文件并配置以下变量：

```env
# === Twitter API配置 ===
TWITTER_API_KEY=your_api_key_here
TWITTER_API_SECRET=your_api_secret_here
TWITTER_ACCESS_TOKEN=your_access_token_here
TWITTER_ACCESS_TOKEN_SECRET=your_access_token_secret_here

# === Google Gemini API配置 ===
GEMINI_API_KEY=your_gemini_api_key_here

# === 数据库配置 ===
DATABASE_URL=sqlite:///data/twitter_publisher.db
# PostgreSQL示例: postgresql://user:password@localhost:5432/dbname

# === API服务配置 ===
API_HOST=127.0.0.1
API_PORT=8050
API_DEBUG=false
API_API_KEY=your_secure_api_key_here

# === 安全配置 ===
SECRET_KEY=your_secret_key_here
ALLOWED_HOSTS=localhost,127.0.0.1
```

### 应用配置文件

编辑 `config/enhanced_config.yaml`：

```yaml
# 项目基础路径
project_base_path: "./project"

# 日志配置
logs:
  path: "./logs/app.log"
  level: "INFO"
  max_bytes: 10485760  # 10MB
  backup_count: 5

# 调度器配置
scheduler:
  interval_minutes_min: 15
  interval_minutes_max: 30
  max_retries: 3
  retry_delay_base: 60  # 秒

# 发布配置
publishing:
  default_language: "en"
  use_ai_enhancement: true
  max_video_size_mb: 512
  supported_formats: ["mp4", "mov", "avi"]

# 数据库配置
database:
  path: "./data/twitter_publisher.db"
  pool_size: 10
  max_overflow: 20

# 安全配置
security:
  rate_limit_per_minute: 60
  session_timeout: 3600
  password_min_length: 8
```

## 📖 使用指南

### 1. 项目结构规范

将视频项目按以下结构组织：

```
project/
├── project-name-1/
│   ├── output_video_music/    # 视频文件目录
│   │   ├── video1.mp4
│   │   └── video2.mov
│   └── uploader_json/         # 元数据文件目录
│       ├── video1_en.json    # 英文元数据
│       ├── video1_zh.json    # 中文元数据
│       ├── video2_en.json
│       └── video2_zh.json
└── project-name-2/
    └── ...
```

### 2. 元数据文件格式

```json
{
  "title": "视频标题",
  "description": "详细的视频描述，支持多行文本",
  "tags": ["科技", "教程", "Python"],
  "language": "zh",
  "category": "education",
  "publish_time": "2024-01-01T12:00:00Z",
  "visibility": "public",
  "custom_fields": {
    "hashtags": "#Python #编程 #教程",
    "mention_users": ["@username1", "@username2"]
  }
}
```

### 3. 启动服务

#### API服务启动

```bash
# 方法一：使用启动脚本（推荐）
./start_api.sh

# 方法二：使用Python命令
python -m app.main api

# 方法三：使用专用启动器
python scripts/server/start_api.py

# 开发模式（自动重载）
python scripts/server/start_api.py --debug
```

#### 命令行工具

```bash
# 验证配置
python scripts/start.py validate

# 扫描项目并创建任务
python scripts/start.py scan

# 启动任务调度器
python scripts/start.py scheduler

# 详细输出模式
python scripts/start.py api --verbose
```

### 4. 访问应用

启动服务后，可以通过以下地址访问：

- **Web界面**: http://localhost:8080
- **API文档**: http://localhost:8050/docs
- **ReDoc文档**: http://localhost:8050/redoc
- **健康检查**: http://localhost:8050/api/health

## 🔧 开发模式

### 开发环境设置

```bash
# 1. 克隆项目
git clone <repository-url>
cd twitter-trend

# 2. 创建开发环境
python -m venv venv
source venv/bin/activate

# 3. 安装开发依赖
pip install -r requirements.txt
pip install -r requirements-dev.txt  # 如果存在

# 4. 设置开发配置
export API_DEBUG=true
export API_RELOAD=true

# 5. 启动开发服务器
python scripts/start.py api --reload --verbose
```

### 调试模式

启用调试模式以获得更好的开发体验：

```bash
# 使用启动脚本
./start_api.sh -d

# 或使用命令行
python -m app.main api --debug
```

调试模式特性：
- 自动重载代码变更
- 详细的错误信息
- 增强的日志输出

## 🔍 验证安装

### 系统健康检查

```bash
# API健康检查
curl http://localhost:8080/api/health

# 系统状态检查
curl http://localhost:8050/api/v1/dashboard/health

# 配置验证
python scripts/start.py validate
```

### 功能测试

```bash
# 测试Twitter API连接
python -c "
from app.core.publisher import TwitterPublisher
from app.utils.config import get_config
config = get_config()
publisher = TwitterPublisher(config)
print('Twitter API连接:', publisher.verify_credentials())
"

# 测试数据库连接
python -c "
from app.database.database import get_database
db = get_database()
print('数据库连接成功')
"
```

## 🚨 常见问题

### 1. Twitter API认证失败

**症状**: `401 Unauthorized` 错误

**解决方案**:
```bash
# 检查API密钥配置
python scripts/start.py validate

# 验证环境变量
echo $TWITTER_API_KEY
```

### 2. 端口被占用

**症状**: `Address already in use` 错误

**解决方案**:
```bash
# 查看端口占用
lsof -i :8080

# 使用其他端口
python scripts/start.py api --port 8050
```

### 3. 依赖包缺失

**症状**: `ModuleNotFoundError` 错误

**解决方案**:
```bash
# 重新安装依赖
pip install -r requirements.txt

# 检查虚拟环境
which python
```

### 4. 数据库连接失败

**症状**: `sqlite3.OperationalError` 错误

**解决方案**:
```bash
# 检查数据库文件权限
ls -la data/twitter_publisher.db

# 重新初始化数据库
rm data/twitter_publisher.db
python scripts/start.py api  # 自动创建数据库
```

## 📞 获取帮助

如果遇到问题，可以通过以下方式获取支持：

- 📖 [完整文档](docs/)
- 🐛 [报告Bug](../../issues/new?template=bug_report.md)
- 💡 [功能请求](../../issues/new?template=feature_request.md)
- ❓ [提问讨论](../../discussions)

---

**下一步**: 查看 [API文档](02_API文档.md) 了解详细的接口使用方法。