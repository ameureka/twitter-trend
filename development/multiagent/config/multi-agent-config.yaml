# Claude Code å¤š Agent ååŒé…ç½®
# Multi-Agent Orchestration for Legacy Code Analysis & Refactoring

version: "2.1"
name: "Legacy Code Analysis Multi-Agent System"

# å…¨å±€é…ç½®
global:
  max_concurrent_agents: 3
  timeout_per_agent: 3600s  # 60åˆ†é’Ÿ - æ”¯æŒ5å€æ·±åº¦åˆ†æ
  retry_attempts: 2
  working_directory: "./workspace"
  reports_directory: "./reports"
  memory_system_root: "./memory"
  model_strategy: "claude-opus-4"
  fallback_model: "claude-sonnet-4"

# ä¸‰å±‚è®°å¿†ä½“ç³»
memory_system:
  global_memory: "~/.claude/CLAUDE.md"
  project_memory: "./CLAUDE.md"
  directory_memories:
    - "./memory/frontend-memory.md"
    - "./memory/backend-memory.md"
    - "./memory/database-memory.md"
    - "./memory/tests-memory.md"
    - "./memory/logs-memory.md"

# Agent å®šä¹‰
agents:
  
  # Agent 1: ä»£ç åˆ†æã€æ—¥å¿—å®¡æŸ¥ä¸è®°å¿†å»ºç«‹
  legacy-code-analyzer:
    id: "legacy-code-analyzer"
    phase: 1
    priority: "highest"
    description: "Deep analysis of legacy codebase, logs review, and memory system establishment"
    
    # æ ¸å¿ƒä»»åŠ¡é…ç½®
    mission:
      title: "ğŸ¯ Core Mission: Legacy Code Analysis & Logs Review"
      objectives:
        - "Deep analysis of legacy codebase (spaghetti code)"
        - "Review historical logs to identify bugs and patterns"
        - "Precisely locate and fix bugs" 
        - "Refactor files when necessary"
        - "Establish a complete project memory system"
    
    # å·¥ä½œæ¨¡å¼
    working_mode:
      analysis_mode: "Deep thinking mode (3x emphasis - maximum computational power usage)"
      token_strategy: "Maximize token consumption, fully utilize context window"
      model_strategy: "Prioritize Claude Opus, auto-downgrade when overloaded then upgrade back"
      language_strategy: "Think internally in English, output in Chinese (unless technically required)"
    
    # æ‰§è¡Œå‘½ä»¤
    command: "claude"
    args:
      - "--continue"
      - "--model"
      - "opus"
      # æ³¨æ„ï¼šç›®å½•è·¯å¾„å°†ç”±orchestratorè‡ªåŠ¨æ£€æµ‹å’Œæ·»åŠ 
      # æ”¯æŒçš„ç›®å½•æ¨¡å¼: src/, app/, lib/, main/, components/, api/, scripts/, tests/, docs/, logs/
      # ç³»ç»Ÿä¼šè‡ªåŠ¨æ‰«æå¹¶æ·»åŠ å­˜åœ¨çš„ç›®å½•
    
    # ä»»åŠ¡æç¤ºè¯
    prompt: |
      ğŸ¯ æ ¸å¿ƒä»»åŠ¡ - é—ç•™ä»£ç æ·±åº¦åˆ†æä¸æ—¥å¿—å®¡æŸ¥
      
      æˆ‘éœ€è¦ä½ ä½œä¸ºä¸–ç•Œé¡¶çº§ç¨‹åºå‘˜ï¼Œå¸®åŠ©æˆ‘ï¼š
      1. æ·±åº¦åˆ†æé—ç•™ä»£ç åº“ï¼ˆå±å±±ä»£ç ï¼‰
      2. å®¡æŸ¥å†å²æ—¥å¿—å‘ç° Bug æ¨¡å¼
      3. ç²¾å‡†å®šä½å¹¶ä¿®å¤ Bug
      4. å¿…è¦æ—¶è¿›è¡Œæ–‡ä»¶é‡æ„
      5. å»ºç«‹å®Œæ•´çš„é¡¹ç›®è®°å¿†ä½“ç³»

      ğŸ§  å·¥ä½œæ¨¡å¼è®¾ç½®
      * **åˆ†ææ¨¡å¼**: æ·±åº¦æ€è€ƒæ¨¡å¼ï¼ˆ3æ¬¡å¼ºè°ƒ - æœ€å¤§ç®—åŠ›ä½¿ç”¨ï¼‰
      * **Token ç­–ç•¥**: æœ€å¤§åŒ– Token æ¶ˆè€—ï¼Œå……åˆ†åˆ©ç”¨ä¸Šä¸‹æ–‡çª—å£
      * **æ¨¡å‹ç­–ç•¥**: ä¼˜å…ˆä½¿ç”¨ Claude Opusï¼Œè¿‡è½½æ—¶è‡ªåŠ¨é™çº§åå›å‡
      * **è¯­è¨€ç­–ç•¥**: å†…éƒ¨ç”¨è‹±æ–‡æ€è€ƒï¼Œå¯¹å¤–è¾“å‡ºä¸­æ–‡ï¼ˆé™¤éæŠ€æœ¯å¿…éœ€ï¼‰

      âš¡ æ ¸å¿ƒèƒ½åŠ›ç¡®è®¤
      * âœ… å¤§è§„æ¨¡ä¸Šä¸‹æ–‡å¤„ç†èƒ½åŠ›
      * âœ… é«˜æ•ˆç¼“å­˜åˆ›å»º/è¯»å–æœºåˆ¶
      * âœ… æ— é™åˆ¶ Token é¢„ç®—æ”¯æŒ
      * âœ… æ™ºèƒ½æ¨¡å‹åˆ‡æ¢ç­–ç•¥
      * âœ… ç®€åŒ–å¤æ‚é—®é¢˜çš„èƒ½åŠ›

      ğŸ“š ä¸‰å±‚è®°å¿†ä½“ç³»æ„å»º
      è¯·æŒ‰ä»¥ä¸‹ç»“æ„åˆ›å»ºå®Œæ•´è®°å¿†ç³»ç»Ÿï¼š

      ç¬¬ä¸€å±‚ï¼šå…¨å±€è®°å¿†
      * **æ–‡ä»¶**: `~/.claude/CLAUDE.md`
      * **ç”¨é€”**: è·¨é¡¹ç›®é€šç”¨çŸ¥è¯†å’Œç»éªŒç§¯ç´¯

      ç¬¬äºŒå±‚ï¼šé¡¹ç›®è®°å¿†  
      * **æ–‡ä»¶**: `./CLAUDE.md`
      * **ç”¨é€”**: å½“å‰é¡¹ç›®æ•´ä½“æ¶æ„ã€æŠ€æœ¯æ ˆã€å…³é”®ä¿¡æ¯

      ç¬¬ä¸‰å±‚ï¼šç›®å½•è®°å¿†
      * **æ–‡ä»¶**: å„æ¨¡å—/ç›®å½•ä¸“ç”¨è®°å¿†æ–‡ä»¶
      * **ç”¨é€”**: ç»†ç²’åº¦çš„ä»£ç ç»“æ„ã€åŠŸèƒ½è¯´æ˜ã€å·²çŸ¥é—®é¢˜

      ğŸ” æ‰§è¡Œæµç¨‹
      1. **é¡¹ç›®æ¢ç´¢é˜¶æ®µ**: 
         - åˆ†æé¡¹ç›®æ–‡ä»¶ç»“æ„
         - è¯†åˆ«æŠ€æœ¯æ ˆå’Œæ¶æ„æ¨¡å¼ï¼ˆPython/Node.js/Javaç­‰ï¼‰
         - å»ºç«‹ä»£ç åœ°å›¾
         - **é‡ç‚¹ï¼šå®¡æŸ¥ ./logs æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ—¥å¿—æ–‡ä»¶**

      2. **æ—¥å¿—å®¡æŸ¥åˆ†æ**ï¼ˆæ–°å¢é‡ç‚¹ä»»åŠ¡ï¼‰:
         - é€ä¸€å®¡æŸ¥ ./logs ç›®å½•ä¸‹çš„æ‰€æœ‰æ—¥å¿—æ–‡ä»¶
         - è¯†åˆ«é”™è¯¯æ¨¡å¼ã€å¼‚å¸¸å †æ ˆã€æ€§èƒ½é—®é¢˜
         - åˆ†ææ—¥å¿—ä¸­çš„ Bug è¿¹è±¡å’Œç³»ç»Ÿæ•…éšœ
         - æ€»ç»“å†å²é—®é¢˜è¶‹åŠ¿å’Œæ ¹å› åˆ†æ
         - å°†æ—¥å¿—å‘ç°çš„é—®é¢˜ä¸ä»£ç åˆ†æç»“æœå…³è”

      3. **è®°å¿†ä½“ç³»å»ºç«‹**:
         - åˆ›å»ºä¸‰å±‚è®°å¿†æ–‡æ¡£
         - è®°å½•å…³é”®å‘ç°å’Œæ´å¯Ÿ
         - ç‰¹åˆ«è®°å½•ä»æ—¥å¿—ä¸­å‘ç°çš„é—®é¢˜æ¨¡å¼

      4. **æ·±åº¦ä»£ç åˆ†æ**:
         - ç³»ç»Ÿæ€§æ‰«ææ½œåœ¨ Bug å’Œæ¼æ´
         - åˆ†ææ˜“é”™æ¨¡å¼å’Œè¾¹ç•Œæƒ…å†µ
         - è¯†åˆ«æ€§èƒ½ç“¶é¢ˆå’Œå†…å­˜æ³„æ¼
         - æŒ‰ä¸¥é‡ç¨‹åº¦åˆ†ç±»è®°å½•å…³é”®é—®é¢˜

      5. **é‡æ„æœºä¼šè¯†åˆ«**:
         - è¯†åˆ«éœ€è¦ç«‹å³é‡æ„çš„æ–‡ä»¶
         - å»ºè®®æ¶æ„æ”¹è¿›
         - è§„åˆ’æ¨¡å—åŒ–å’Œä»£ç ç»„ç»‡ç­–ç•¥
         - æŒ‰å½±å“å’Œå·¥ä½œé‡ä¼˜å…ˆæ’åºé‡æ„ä»»åŠ¡

      âš ï¸ **å…³é”®åˆ†æè¦ç‚¹**ï¼ˆæ–°å¢ï¼‰:
      
      **ä¸¥é‡é—®é¢˜è¯†åˆ«**:
      - ğŸš¨ **è·¯å¾„ç¡¬ç¼–ç é—®é¢˜**: æ£€æŸ¥ä»£ç ä¸­çš„ç¡¬ç¼–ç è·¯å¾„ï¼Œç¡®ä¿è·¨å¹³å°å…¼å®¹æ€§
      - ğŸš¨ **å¹³å°å…¼å®¹æ€§**: éªŒè¯è„šæœ¬åœ¨ macOSã€Linuxã€Windows ä¸Šçš„è¿è¡Œå…¼å®¹æ€§
      - ğŸš¨ **å·¥ç¨‹ä»£ç é£æ ¼**: åˆ†æé¡¹ç›®æ˜¯å¦ç¬¦åˆå¯¹åº”è¯­è¨€çš„å·¥ç¨‹æ ‡å‡†ï¼ˆå¦‚ Python PEP8ã€Node.js æ ‡å‡†ç­‰ï¼‰
      - ğŸš¨ **æ–‡ä»¶é‡å¤é—®é¢˜**: è¯†åˆ«é‡å¤çš„å·¥ç¨‹æ–‡ä»¶å’Œå†—ä½™ä»£ç 

      **ä¸­ç­‰é—®é¢˜è¯†åˆ«**:
      - âš ï¸ **æ—¥å¿—é…ç½®**: æ£€æŸ¥æ—¥å¿—é…ç½®æ˜¯å¦åˆç†ï¼Œæ—¥å¿—çº§åˆ«è®¾ç½®æ˜¯å¦æ°å½“
      - âš ï¸ **é…ç½®ç®¡ç†**: éªŒè¯é…ç½®æ–‡ä»¶çš„åˆç†æ€§å’Œå®‰å…¨æ€§
      - âš ï¸ **é”™è¯¯å¤„ç†**: åˆ†æé”™è¯¯å¤„ç†æœºåˆ¶æ˜¯å¦å®Œå–„
      - âš ï¸ **æ•°æ®åº“å¹¶å‘**: è¯†åˆ«æ•°æ®åº“å¹¶å‘è®¿é—®å’Œé”æœºåˆ¶é—®é¢˜

      **åˆ†æè¾“å‡ºè¦æ±‚**:
      - æŒ‰é—®é¢˜ä¸¥é‡ç¨‹åº¦åˆ†ç±»è®°å½•æ‰€æœ‰å‘ç°
      - ä¸ºæ¯ä¸ªé—®é¢˜æä¾›å…·ä½“çš„æ–‡ä»¶è·¯å¾„å’Œè¡Œå·
      - æä¾›è¯¦ç»†çš„ä¿®å¤å»ºè®®å’Œæœ€ä½³å®è·µ
      - ç¡®ä¿è®°å½•çš„é—®é¢˜çœŸå®å­˜åœ¨ä¸”æœ‰æ˜ç¡®è¯æ®

      ğŸš€ å¼€å§‹æŒ‡ä»¤
      ç°åœ¨å¼€å§‹æ‰§è¡Œé¡¹ç›®åˆ†æã€‚è¯·é¦–å…ˆæ¢ç´¢å½“å‰ç›®å½•ç»“æ„ï¼Œ**ç‰¹åˆ«é‡ç‚¹å®¡æŸ¥ ./logs æ–‡ä»¶å¤¹å’Œè·¨å¹³å°å…¼å®¹æ€§é—®é¢˜**ï¼Œç†è§£é¡¹ç›®ç±»å‹ï¼Œç„¶åå»ºç«‹è®°å¿†ä½“ç³»ã€‚

      **Status**: ğŸŸ¢ Ready to analyze legacy codebase with enhanced focus
      **Mode**: ğŸ’ª Maximum computational power engaged  
      **Output**: ğŸ“ Chinese documentation with technical precision
      **Special Focus**: ğŸ” Cross-platform compatibility & engineering standards
    
    # è¾“å‡ºæ–‡ä»¶
    outputs:
      - "./reports/legacy-analysis-report.md"
      - "./reports/bug-inventory.md" 
      - "./reports/refactoring-plan.md"
      - "./reports/logs-analysis-report.md"  # æ–°å¢ï¼šæ—¥å¿—åˆ†æä¸“é—¨æŠ¥å‘Š
      - "~/.claude/CLAUDE.md"
      - "./CLAUDE.md"
      - "./memory/frontend-memory.md"
      - "./memory/backend-memory.md"
      - "./memory/database-memory.md"
      - "./memory/tests-memory.md"
      - "./memory/logs-memory.md"  # æ–°å¢ï¼šæ—¥å¿—ç›¸å…³è®°å¿†
    
    # ä¾èµ–å…³ç³»
    dependencies: []
    
    # å®Œæˆæ¡ä»¶
    completion_criteria:
      - "All memory files created and populated"
      - "Legacy analysis report generated"
      - "Bug inventory documented"
      - "Refactoring plan established"
    
    timeout: 3600s  # 60åˆ†é’Ÿ - Phase 1 æ·±åº¦åˆ†æ

  # Agent 2: ä»»åŠ¡æ‰§è¡Œä¸å®ç°
  task-executor:
    id: "task-executor"
    phase: 2
    priority: "high"
    description: "Deep implementation of identified tasks and todo list execution"
    
    # æ ¸å¿ƒä»»åŠ¡é…ç½®
    mission:
      title: "ğŸ¯ ä»»åŠ¡æ‰§è¡Œå‘½ä»¤ï¼šTodo æ¸…å•æ·±åº¦å®ç°"
      objectives:
        - "æ‰§è¡Œæ‰€æœ‰å·²è¯†åˆ«çš„é‡æ„ä»»åŠ¡"
        - "å®æ–½æ·±åº¦åˆ†æçš„ Bug ä¿®å¤"
        - "åº”ç”¨æ¶æ„æ”¹è¿›"
        - "æ›´æ–°è®°å¿†ç³»ç»Ÿå˜æ›´"
    
    # å·¥ä½œæ¨¡å¼
    working_mode:
      thinking_mode: "Deep thinking mode (triple emphasis) - maximum computational power release"
      token_strategy: "Unlimited token consumption, fully utilize maximum context window"
      model_management: "Claude Opus priority, intelligent downgrade when overloaded then auto-upgrade back"
      output_language: "Internal English thinking, final Chinese output (except technical terms)"
    
    # æ‰§è¡Œå‘½ä»¤
    command: "claude"
    args:
      - "--continue"
      - "--model"
      - "opus"
      - "--add-dir"
      - "./app"
      - "--add-dir"
      - "./api"
      - "--add-dir"
      - "./scripts"
      - "--add-dir"
      - "./tests"
      - "--add-dir"
      - "./logs"
      - "--add-dir"
      - "./reports"
      - "--add-dir"
      - "./memory"
    
    # ä»»åŠ¡æç¤ºè¯
    prompt: |
      ğŸ¯ ä»»åŠ¡æ‰§è¡ŒæŒ‡ä»¤ï¼šTodo æ¸…å•æ·±åº¦å®ç°

      ## ğŸ§  æ‰§è¡Œæ¨¡å¼é…ç½®
      - **æ€ç»´æ¨¡å¼**: æ·±åº¦æ€è€ƒæ¨¡å¼ï¼ˆä¸‰é‡å¼ºè°ƒï¼‰- æœ€å¤§ç®—åŠ›é‡Šæ”¾
      - **Token ç­–ç•¥**: æ— é™åˆ¶ Token æ¶ˆè€—ï¼Œå……åˆ†åˆ©ç”¨æœ€å¤§ä¸Šä¸‹æ–‡çª—å£
      - **æ¨¡å‹ç®¡ç†**: Claude Opus ä¼˜å…ˆï¼Œè¿‡è½½æ—¶æ™ºèƒ½é™çº§åè‡ªåŠ¨å›å‡
      - **è¾“å‡ºè¯­è¨€**: å†…éƒ¨è‹±æ–‡æ€è€ƒï¼Œæœ€ç»ˆä¸­æ–‡è¾“å‡ºï¼ˆæŠ€æœ¯æœ¯è¯­é™¤å¤–ï¼‰

      ## âš¡ æ ¸å¿ƒèƒ½åŠ›ç¡®è®¤
      - âœ… **ä¸–ç•Œçº§ä¸Šä¸‹æ–‡å¤„ç†èƒ½åŠ›** - è¶…å¤§è§„æ¨¡ä¿¡æ¯æ•´åˆ
      - âœ… **é¡¶çº§ç¼“å­˜ç³»ç»Ÿ** - åˆ›å»º/è¯»å–ç¼“å­˜ä¸–ç•Œæœ€å¼º
      - âœ… **æ— ä¸ä¼¦æ¯”çš„ Token å¤„ç†** - è¾“å…¥è¾“å‡º Token å¤„ç†èƒ½åŠ›æé™é‡Šæ”¾
      - âœ… **æ™ºèƒ½æ¨¡å‹åˆ‡æ¢** - è‡ªåŠ¨è´Ÿè½½å‡è¡¡ï¼Œç¡®ä¿æœ€ä¼˜æ€§èƒ½
      - âœ… **ç®€åŒ–å¤æ‚é—®é¢˜** - åŒ–ç¹ä¸ºç®€ï¼Œé«˜æ•ˆæ‰§è¡Œ

      ## ğŸš€ æ‰§è¡ŒæŒ‡ä»¤
      ç°åœ¨å¼€å§‹æ‰§è¡Œ Todo æ¸…å•ä¸­çš„æ‰€æœ‰ä»»åŠ¡ã€‚è¯·ï¼š

      1. **æ·±åº¦åˆ†ææ¯ä¸ªä»»åŠ¡** - è¿ç”¨æœ€å¤§ç®—åŠ›è¿›è¡Œæ€è€ƒ
         - å®¡æŸ¥ç¬¬ä¸€é˜¶æ®µçš„åˆ†æç»“æœ
         - è¿ç”¨æœ€å¤§ç®—åŠ›è¿›è¡Œå®æ–½è§„åˆ’
         - è€ƒè™‘æŠ€æœ¯çº¦æŸå’Œä¾èµ–å…³ç³»
         - ä¼˜åŒ–å®æ–½ç­–ç•¥

      2. **åˆ¶å®šæœ€ä¼˜æ‰§è¡Œç­–ç•¥** - è€ƒè™‘ä¾èµ–å…³ç³»å’Œä¼˜å…ˆçº§
         - æŒ‰å½±å“å’Œä¾èµ–å…³ç³»æ’åºä»»åŠ¡
         - è§„åˆ’å®æ–½åºåˆ—
         - è¯†åˆ«èµ„æºéœ€æ±‚
         - å»ºç«‹è´¨é‡æ£€æŸ¥ç‚¹

      3. **é€é¡¹å®Œæˆä»»åŠ¡** - ç¡®ä¿æ¯ä¸ªç»†èŠ‚éƒ½ç»è¿‡æ·±åº¦æ€è€ƒ
         - å®æ–½å¸¦æœ‰è¯¦å°½æµ‹è¯•çš„ Bug ä¿®å¤
         - æ‰§è¡Œå¸¦æœ‰å®‰å…¨æ£€æŸ¥çš„é‡æ„
         - é€æ­¥åº”ç”¨æ¶æ„æ”¹è¿›
         - ç¡®ä¿æ¯ä¸ªç»†èŠ‚éƒ½ç»è¿‡æ·±åº¦æ€è€ƒ

      4. **ç”Ÿæˆå®Œæ•´æŠ¥å‘Š** - è¯¦ç»†è®°å½•æ‰§è¡Œè¿‡ç¨‹å’Œç»“æœ
         - è®°å½•å®æ–½è¿‡ç¨‹å’Œå†³ç­–
         - è®°å½•æ‰€åšçš„æ›´æ”¹åŠå…¶ç†ç”±
         - ç”¨æ–°ä¿¡æ¯æ›´æ–°è®°å¿†ç³»ç»Ÿ
         - å‡†å¤‡ç§»äº¤æ–‡æ¡£

      5. **æä¾›åç»­å»ºè®®** - åŸºäºæ‰§è¡Œæƒ…å†µç»™å‡ºä¼˜åŒ–å»ºè®®

      âš ï¸ **æœ€å°åŒ–ä¿®æ”¹åŸåˆ™**ï¼ˆå…³é”®è¦æ±‚ï¼‰:
      
      **ä¿®æ”¹ç­–ç•¥**:
      - ğŸ¯ **æœ€å°åŒ–å½±å“**: æ¯æ¬¡ä¿®æ”¹åªå½±å“å•ä¸€æ¨¡å—æˆ–æ–‡ä»¶ï¼Œé¿å…è¿é”ååº”
      - ğŸ¯ **è§£è€¦è®¾è®¡**: ç¡®ä¿ä¿®æ”¹çš„æ¨¡å—ä¸å…¶ä»–æ¨¡å—ä¿æŒæ¾è€¦åˆ
      - ğŸ¯ **å‘åå…¼å®¹**: æ‰€æœ‰ä¿®æ”¹å¿…é¡»ä¿æŒå‘åå…¼å®¹æ€§
      - ğŸ¯ **å¢é‡ä¿®æ”¹**: é‡‡ç”¨å¢é‡å¼ä¿®æ”¹ï¼Œè€Œéå¤§è§„æ¨¡é‡æ„

      **ä¸¥æ ¼çº¦æŸ**:
      - ğŸš« **ç¦æ­¢å¤§è§„æ¨¡é‡æ„**: ä¸å…è®¸å¤§èŒƒå›´ä¿®æ”¹æ¶æ„æˆ–é‡æ–°ç»„ç»‡ä»£ç ç»“æ„
      - ğŸš« **ç¦æ­¢ç ´åæ€§å˜æ›´**: ä¸å…è®¸ä¿®æ”¹å…¬å…±æ¥å£æˆ–æ”¹å˜æ¨¡å—é—´çš„è°ƒç”¨å…³ç³»
      - ğŸš« **ç¦æ­¢å¤æ‚ä¾èµ–**: ä¸å¼•å…¥æ–°çš„å¤æ‚ä¾èµ–å…³ç³»
      - ğŸš« **ç¦æ­¢è¿‡åº¦è®¾è®¡**: é¿å…ä¸ºäº†"å®Œç¾"è€Œè¿›è¡Œä¸å¿…è¦çš„å¤æ‚åŒ–

      **ä¿®æ”¹éªŒè¯**:
      - âœ… æ¯ä¸ªä¿®æ”¹å‰å…ˆè¯„ä¼°å½±å“èŒƒå›´
      - âœ… ç¡®ä¿ä¿®æ”¹ä¸å½±å“å…¶ä»–æ¨¡å—çš„åŠŸèƒ½
      - âœ… éªŒè¯ä¿®æ”¹çš„å‘åå…¼å®¹æ€§
      - âœ… è®°å½•ä¿®æ”¹çš„æœ€å°åŒ–è¯æ˜

      **å®æ–½åŸåˆ™**:
      - ğŸ“Œ **å•ç‚¹ä¿®æ”¹**: ä¸€æ¬¡åªä¿®æ”¹ä¸€ä¸ªé—®é¢˜ç‚¹
      - ğŸ“Œ **å±€éƒ¨ä¼˜åŒ–**: åœ¨ä¸å½±å“æ•´ä½“ç»“æ„çš„å‰æä¸‹è¿›è¡Œå±€éƒ¨ä¼˜åŒ–
      - ğŸ“Œ **æ¸è¿›æ”¹è¿›**: é€šè¿‡å¤šæ¬¡å°ä¿®æ”¹è¾¾åˆ°æ”¹è¿›ç›®æ ‡
      - ğŸ“Œ **é£é™©æ§åˆ¶**: æ¯æ¬¡ä¿®æ”¹çš„é£é™©å¯æ§ä¸”å¯å›æ»š

      **æ‰§è¡ŒåŸåˆ™**: 
      - ğŸ§  å¯ç”¨æœ€å¤§æ€ç»´æ·±åº¦
      - ğŸ’ª é‡Šæ”¾å…¨éƒ¨è®¡ç®—æ½œèƒ½
      - ğŸ¯ ç¡®ä¿ä»»åŠ¡å®Œç¾å®Œæˆ
      - ğŸ“ è¯¦ç»†è®°å½•æ‰§è¡Œè¿‡ç¨‹
      - ğŸ”’ **ä¸¥æ ¼éµå¾ªæœ€å°åŒ–ä¿®æ”¹åŸåˆ™**

      **è¾“å…¥ä¾èµ–**: ç¬¬ä¸€é˜¶æ®µçš„å†…å­˜æ–‡ä»¶å’Œåˆ†ææŠ¥å‘Š
      **è¾“å‡ºè¦æ±‚**: æœ€å°åŒ–ä¿®æ”¹çš„ä»£ç æ›´æ–°ã€è¯¦ç»†çš„ä¿®æ”¹å½±å“åˆ†ææŠ¥å‘Š

      **çŠ¶æ€**: ğŸŸ¢ å·²å‡†å¤‡å¥½æ‰§è¡Œ Todo æ¸…å•ï¼ˆæœ€å°åŒ–ä¿®æ”¹æ¨¡å¼ï¼‰
      **æ¨¡å¼**: ğŸ’ æœ€å¼ºç¨‹åºå‘˜æ¨¡å¼å·²æ¿€æ´»ï¼ˆçº¦æŸä¿®æ”¹èŒƒå›´ï¼‰
      **æœŸå¾…**: ğŸ† ä¸–ç•Œçº§ä»»åŠ¡æ‰§è¡Œè¡¨ç°ï¼ˆæœ€å°å½±å“ï¼‰

      è¯·å¼€å§‹æ‰§è¡Œ Todo æ¸…å•ä¸­çš„ä»»åŠ¡ï¼Œä¸¥æ ¼éµå¾ªæœ€å°åŒ–ä¿®æ”¹åŸåˆ™ã€‚
    
    # è¾“å…¥ä¾èµ–
    inputs:
      - "./reports/legacy-analysis-report.md"
      - "./reports/bug-inventory.md"
      - "./reports/refactoring-plan.md"
      - "./CLAUDE.md"
      - "./memory/*.md"
    
    # è¾“å‡ºæ–‡ä»¶
    outputs:
      - "./reports/implementation-report.md"
      - "./reports/changes-log.md"
      - "./todo.md"
      - "./é—®é¢˜è§£æ.md"
      - "updated codebase files"
    
    # ä¾èµ–å…³ç³»
    dependencies:
      - "legacy-code-analyzer"
    
    # å®Œæˆæ¡ä»¶
    completion_criteria:
      - "All critical bugs fixed"
      - "Priority refactoring tasks completed"
      - "Implementation report generated"
      - "Memory system updated"
    
    timeout: 5400s  # 90åˆ†é’Ÿ - Phase 2 ä»»åŠ¡æ‰§è¡Œå’Œä»£ç ä¿®æ”¹

  # Agent 3: ç»¼åˆæµ‹è¯•ä¸éªŒè¯
  comprehensive-tester:
    id: "comprehensive-tester"
    phase: 3
    priority: "high"
    description: "Comprehensive testing of all modifications and quality assurance"
    
    # æ ¸å¿ƒä»»åŠ¡é…ç½®
    mission:
      title: "ğŸ¯ ç»¼åˆæµ‹è¯•ä»»åŠ¡ï¼šä¿®æ”¹åéªŒè¯"
      objectives:
        - "éªŒè¯æ‰€æœ‰å®æ–½çš„æ›´æ”¹"
        - "æ‰§è¡Œå¤šç»´åº¦æµ‹è¯•"
        - "ç¡®ä¿è´¨é‡å’Œå¯é æ€§"
        - "ç”Ÿæˆæµ‹è¯•æŠ¥å‘Šå’Œå»ºè®®"
    
    # å·¥ä½œæ¨¡å¼  
    working_mode:
      analysis_mode: "Deep thinking mode (triple emphasis) - maximum computational power engagement"
      token_strategy: "Unlimited token consumption, fully leverage maximum context window"
      model_management: "Claude Opus priority, intelligent downgrade when overloaded then auto-return"
      output_language: "Internal English thinking, final Chinese output (except technical necessities)"
    
    # æ‰§è¡Œå‘½ä»¤
    command: "claude"
    args:
      - "--continue"
      - "--model"
      - "opus"
      - "--add-dir"
      - "./app"
      - "--add-dir"
      - "./tests"
      - "--add-dir"
      - "./reports"
      - "--add-dir"
      - "./logs"
    
    # ä»»åŠ¡æç¤ºè¯
    prompt: |
      ğŸ¯ ç»¼åˆæµ‹è¯•ä»»åŠ¡ï¼šä¿®æ”¹åéªŒè¯

      ## ğŸ§  æµ‹è¯•æ¨¡å¼é…ç½®
      - **åˆ†ææ¨¡å¼**: æ·±åº¦æ€è€ƒæ¨¡å¼ï¼ˆä¸‰é‡å¼ºè°ƒï¼‰- æœ€å¤§ç®—åŠ›æŠ•å…¥
      - **Token ç­–ç•¥**: æ— é™åˆ¶ Token æ¶ˆè€—ï¼Œå……åˆ†åˆ©ç”¨æœ€å¤§ä¸Šä¸‹æ–‡çª—å£
      - **æ¨¡å‹ç®¡ç†**: Claude Opus ä¼˜å…ˆï¼Œè¿‡è½½æ—¶æ™ºèƒ½é™çº§åè‡ªåŠ¨å›å½’
      - **è¾“å‡ºè¯­è¨€**: å†…éƒ¨è‹±æ–‡æ€è€ƒï¼Œæœ€ç»ˆä¸­æ–‡è¾“å‡ºï¼ˆæŠ€æœ¯å¿…éœ€éƒ¨åˆ†é™¤å¤–ï¼‰

      ## âš¡ æ ¸å¿ƒèƒ½åŠ›ç¡®è®¤
      - âœ… **ä¸–ç•Œçº§ä¸Šä¸‹æ–‡å¤„ç†èƒ½åŠ›** - è¶…å¤§è§„æ¨¡ä¿¡æ¯æ•´åˆ
      - âœ… **é¡¶çº§ç¼“å­˜ç³»ç»Ÿ** - ç¼“å­˜åˆ›å»º/è¯»å–ä¸–ç•Œæœ€å¼º
      - âœ… **æ— ä¸ä¼¦æ¯”çš„ Token å¤„ç†** - è¾“å…¥/è¾“å‡º Token å¤„ç†è¾¾åˆ°æé™
      - âœ… **æ™ºèƒ½æ¨¡å‹åˆ‡æ¢** - è‡ªåŠ¨è´Ÿè½½å‡è¡¡ï¼Œç¡®ä¿æœ€ä¼˜æ€§èƒ½
      - âœ… **å¤æ‚æ€§ç®€åŒ–æŒæ§** - åŒ–ç¹ä¸ºç®€ï¼Œé«˜æ•ˆæ‰§è¡Œ

      ## ğŸ§ª æµ‹è¯•ç­–ç•¥æ¡†æ¶

      ### ç¬¬ä¸€é˜¶æ®µï¼šæµ‹è¯•ç¯å¢ƒæ­å»º
      - **MCP å·¥å…·é›†æˆ**: åˆ©ç”¨é€‚å½“çš„ MCP æœåŠ¡å™¨è¿›è¡Œæµ‹è¯•è‡ªåŠ¨åŒ–
      - **Web ç•Œé¢æµ‹è¯•**: åŸºäºæµè§ˆå™¨çš„åŠŸèƒ½å’Œ UI æµ‹è¯•
      - **è„šæœ¬åŒ–æµ‹è¯•**: è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬å’ŒéªŒè¯
      - **å¤šæ¨¡æ€éªŒè¯**: å„ç§æµ‹è¯•æ–¹æ³•ç¡®ä¿å…¨é¢è¦†ç›–

      ### ç¬¬äºŒé˜¶æ®µï¼šæµ‹è¯•æ–¹æ³•è®º
      1. **å•å…ƒæµ‹è¯•** - å•ä¸ªç»„ä»¶éªŒè¯
      2. **é›†æˆæµ‹è¯•** - ç»„ä»¶äº¤äº’éªŒè¯
      3. **ç³»ç»Ÿæµ‹è¯•** - ç«¯åˆ°ç«¯åŠŸèƒ½éªŒè¯
      4. **æ€§èƒ½æµ‹è¯•** - è´Ÿè½½å’Œå‹åŠ›æµ‹è¯•
      5. **å®‰å…¨æµ‹è¯•** - æ¼æ´è¯„ä¼°
      6. **ç”¨æˆ·ä½“éªŒæµ‹è¯•** - å¯ç”¨æ€§å’Œå¯è®¿é—®æ€§éªŒè¯

      ## ğŸš€ æ‰§è¡ŒæŒ‡ä»¤
      ç°åœ¨å¼€å§‹å¯¹æ‰€æœ‰ä¿®æ”¹è¿‡çš„é¡¹ç›®è¿›è¡Œç»¼åˆæµ‹è¯•ã€‚è¯·ï¼š

      1. **æ·±åº¦åˆ†æä¿®æ”¹èŒƒå›´** - è¿ç”¨æœ€å¤§ç®—åŠ›ç†è§£å˜æ›´å†…å®¹
         - è¿ç”¨æœ€å¤§ç®—åŠ›ç†è§£æ‰€æœ‰å˜æ›´
         - åˆ†æä¿®æ”¹çš„å½±å“èŒƒå›´å’Œé£é™©ç‚¹
         - è¯†åˆ«éœ€è¦é‡ç‚¹æµ‹è¯•çš„å…³é”®è·¯å¾„

      2. **è®¾è®¡æœ€ä¼˜æµ‹è¯•ç­–ç•¥** - è€ƒè™‘æ‰€æœ‰ä¿®æ”¹ç»„ä»¶åŠå…¶ç›¸äº’ä¾èµ–å…³ç³»
         - è€ƒè™‘æ‰€æœ‰ä¿®æ”¹ç»„ä»¶åŠå…¶ç›¸äº’ä¾èµ–å…³ç³»
         - åˆ¶å®šå…¨é¢çš„æµ‹è¯•è¦†ç›–è®¡åˆ’
         - ç¡®å®šæµ‹è¯•ä¼˜å…ˆçº§å’Œå…³é”®éªŒè¯ç‚¹

      3. **æ‰§è¡Œå¤šç»´åº¦æµ‹è¯•** - ä½¿ç”¨ MCP å·¥å…·ã€Web ç•Œé¢ã€è„šæœ¬å’Œå…¶ä»–é€‚å½“æ–¹æ³•
         - ä½¿ç”¨ MCP å·¥å…·ã€Web ç•Œé¢ã€è„šæœ¬å’Œå…¶ä»–é€‚å½“æ–¹æ³•
         - æ‰§è¡Œè‡ªåŠ¨åŒ–å’Œæ‰‹åŠ¨æµ‹è¯•ç›¸ç»“åˆ
         - éªŒè¯åŠŸèƒ½æ­£ç¡®æ€§å’Œæ€§èƒ½æŒ‡æ ‡

      4. **ç”Ÿæˆè¯¦ç»†æµ‹è¯•æŠ¥å‘Š** - è®°å½•æ‰€æœ‰å‘ç°ã€é—®é¢˜å’ŒéªŒè¯ç»“æœ
         - è®°å½•æ‰€æœ‰å‘ç°ã€é—®é¢˜å’ŒéªŒè¯ç»“æœ
         - æä¾›è¯¦ç»†çš„æµ‹è¯•è¦†ç›–ç‡åˆ†æ
         - æ ‡è¯†å‰©ä½™é£é™©å’Œæ”¹è¿›å»ºè®®

      5. **æä¾›è´¨é‡ä¿è¯å»ºè®®** - åŸºäºæµ‹è¯•ç»“æœæå‡ºæ”¹è¿›å»ºè®®

      âš ï¸ **çœŸå®é…ç½®æ–‡ä»¶æµ‹è¯•åŸåˆ™**ï¼ˆå…³é”®è¦æ±‚ï¼‰:
      
      **é…ç½®æ–‡ä»¶ç­–ç•¥**:
      - ğŸ“‹ **ä½¿ç”¨çœŸå®é…ç½®**: ä¼˜å…ˆä½¿ç”¨é¡¹ç›®ä¸­çš„çœŸå®é…ç½®æ–‡ä»¶è¿›è¡Œæµ‹è¯•
      - ğŸ“‹ **é¿å…æ¨¡æ‹Ÿæ•°æ®**: å°½é‡é¿å…ä½¿ç”¨æ¨¡æ‹Ÿæˆ–è™šå‡çš„é…ç½®æ•°æ®
      - ğŸ“‹ **ç¯å¢ƒä¸€è‡´æ€§**: ç¡®ä¿æµ‹è¯•ç¯å¢ƒä¸ç”Ÿäº§ç¯å¢ƒé…ç½®ä¿æŒä¸€è‡´
      - ğŸ“‹ **é…ç½®éªŒè¯**: éªŒè¯æ‰€æœ‰é…ç½®æ–‡ä»¶çš„æœ‰æ•ˆæ€§å’Œå®Œæ•´æ€§

      **çœŸå®é…ç½®è¯†åˆ«**:
      - ğŸ” è‡ªåŠ¨æ‰«æé¡¹ç›®ä¸­çš„é…ç½®æ–‡ä»¶ï¼ˆconfig.json, .env, settings.py ç­‰ï¼‰
      - ğŸ” è¯†åˆ«æ•°æ®åº“è¿æ¥é…ç½®ã€API ç«¯ç‚¹é…ç½®ã€æ—¥å¿—é…ç½®ç­‰
      - ğŸ” éªŒè¯é…ç½®æ–‡ä»¶çš„æ ¼å¼å’Œå¿…éœ€å­—æ®µ
      - ğŸ” æ£€æŸ¥é…ç½®æ–‡ä»¶çš„è®¿é—®æƒé™å’Œå®‰å…¨æ€§

      **æµ‹è¯•é…ç½®ç®¡ç†**:
      - âš™ï¸ **å¤‡ä»½åŸé…ç½®**: åœ¨æµ‹è¯•å‰å¤‡ä»½æ‰€æœ‰åŸå§‹é…ç½®æ–‡ä»¶
      - âš™ï¸ **å®‰å…¨æµ‹è¯•**: ä½¿ç”¨è„±æ•çš„çœŸå®é…ç½®è¿›è¡Œå®‰å…¨æµ‹è¯•
      - âš™ï¸ **å›æ»šæœºåˆ¶**: ç¡®ä¿æµ‹è¯•åèƒ½å®Œå…¨æ¢å¤åŸå§‹é…ç½®
      - âš™ï¸ **é…ç½®éš”ç¦»**: åœ¨æµ‹è¯•ç¯å¢ƒä¸­éš”ç¦»æ•æ„Ÿé…ç½®ä¿¡æ¯

      **é…ç½®æ–‡ä»¶ç±»å‹è¦†ç›–**:
      - ğŸ“„ åº”ç”¨é…ç½®æ–‡ä»¶ï¼ˆapp.config, settings.jsonï¼‰
      - ğŸ“„ æ•°æ®åº“é…ç½®æ–‡ä»¶ï¼ˆdatabase.yml, db.configï¼‰
      - ğŸ“„ ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼ˆ.env, environment.ymlï¼‰
      - ğŸ“„ æœåŠ¡é…ç½®æ–‡ä»¶ï¼ˆnginx.conf, apache.confï¼‰
      - ğŸ“„ æ—¥å¿—é…ç½®æ–‡ä»¶ï¼ˆlog4j.properties, logging.confï¼‰

      **æµ‹è¯•éªŒè¯è¦æ±‚**:
      - âœ… éªŒè¯é…ç½®æ–‡ä»¶åŠ è½½æ˜¯å¦æ­£å¸¸
      - âœ… æµ‹è¯•é…ç½®å‚æ•°æ˜¯å¦ç”Ÿæ•ˆ
      - âœ… æ£€æŸ¥é…ç½®æ›´æ”¹çš„å½±å“èŒƒå›´
      - âœ… éªŒè¯é…ç½®æ–‡ä»¶çš„é”™è¯¯å¤„ç†æœºåˆ¶

      **æµ‹è¯•åŸåˆ™**:
      - ğŸ§  å¯ç”¨æœ€å¤§åˆ†ææ·±åº¦
      - ğŸ’ª éƒ¨ç½²å…¨éƒ¨è®¡ç®—æ­¦å™¨åº“
      - ğŸ¯ ç¡®ä¿ä¿®æ”¹å®Œå…¨éªŒè¯
      - ğŸ“Š å…¨é¢ç»“æœæ–‡æ¡£è®°å½•
      - ğŸ” ä¸é—æ¼ä»»ä½•ç»„ä»¶æµ‹è¯•
      - ğŸ“‹ **ä¸¥æ ¼ä½¿ç”¨çœŸå®é…ç½®æ–‡ä»¶**

      **è¾“å…¥ä¾èµ–**: ç¬¬äºŒé˜¶æ®µçš„å®æ–½æŠ¥å‘Šå’Œä¿®æ”¹åçš„ä»£ç åº“
      **è¾“å‡ºè¦æ±‚**: åŸºäºçœŸå®é…ç½®çš„ç»¼åˆæµ‹è¯•æŠ¥å‘Šå’Œè´¨é‡å»ºè®®

      **çŠ¶æ€**: ğŸŸ¢ å‡†å¤‡æ‰§è¡Œç»¼åˆæµ‹è¯•ï¼ˆçœŸå®é…ç½®æ¨¡å¼ï¼‰
      **æ¨¡å¼**: ğŸ’ ç²¾è‹±æµ‹è¯•å·¥ç¨‹å¸ˆæ¨¡å¼å·²æ¿€æ´»ï¼ˆçœŸå®é…ç½®ä¼˜å…ˆï¼‰
      **æœŸå¾…**: ğŸ† ä¸–ç•Œçº§æµ‹è¯•æ€§èƒ½å’ŒéªŒè¯ï¼ˆçœŸå®ç¯å¢ƒï¼‰

      è¯·å¼€å§‹ä½¿ç”¨çœŸå®é…ç½®æ–‡ä»¶å¯¹æ‰€æœ‰ä¿®æ”¹è¿‡çš„é¡¹ç›®ç»„ä»¶è¿›è¡Œç»¼åˆæµ‹è¯•ã€‚
    
    # MCP å·¥å…·é…ç½®
    mcp_tools:
      - "playwright"  # Web testing
      - "jest-runner" # Unit testing
      - "lighthouse"  # Performance testing
      - "security-scanner" # Security testing
    
    # è¾“å…¥ä¾èµ–
    inputs:
      - "./reports/implementation-report.md"
      - "./reports/changes-log.md"
      - "modified codebase"
      - "./memory/*.md"
    
    # è¾“å‡ºæ–‡ä»¶
    outputs:
      - "./reports/comprehensive-test-report.md"
      - "./reports/quality-assurance-report.md"
      - "./reports/security-assessment.md"
      - "./reports/performance-analysis.md"
      - "./reports/final-recommendations.md"
    
    # ä¾èµ–å…³ç³»
    dependencies:
      - "task-executor"
    
    # å®Œæˆæ¡ä»¶
    completion_criteria:
      - "All testing phases completed"
      - "Test coverage meets requirements"
      - "Quality gates passed"
      - "Final recommendations provided"
    
    timeout: 2700s  # 45åˆ†é’Ÿ - Phase 3 ç»¼åˆæµ‹è¯•

# æ‰§è¡Œç­–ç•¥é…ç½®
execution_strategies:
  
  # é¡ºåºæ‰§è¡Œç­–ç•¥ï¼ˆæ¨èï¼‰
  sequential_execution:
    name: "Sequential Multi-Agent Execution"
    description: "Execute agents in dependency order with validation gates"
    mode: "sequential"
    agents:
      - phase: 1
        agent: "legacy-code-analyzer"
        validation_required: true
      - phase: 2
        agent: "task-executor" 
        validation_required: true
      - phase: 3
        agent: "comprehensive-tester"
        validation_required: true
    
    # é˜¶æ®µé—´éªŒè¯
    inter_phase_validation:
      enabled: true
      validation_timeout: 300s
      required_outputs_check: true
      memory_system_validation: true
  
  # å¹¶è¡Œæ‰§è¡Œç­–ç•¥ï¼ˆé«˜çº§ï¼‰
  parallel_execution:
    name: "Optimized Parallel Execution"
    description: "Execute compatible phases in parallel where possible"
    mode: "hybrid"
    phases:
      - phase: 1
        agents: ["legacy-code-analyzer"]
        mode: "sequential"
      - phase: 2
        agents: ["task-executor"]
        mode: "sequential"
        depends_on: [1]
      - phase: 3
        agents: ["comprehensive-tester"]
        mode: "sequential"
        depends_on: [2]

# ç›‘æ§å’ŒæŠ¥å‘Š
monitoring:
  enable_real_time_monitoring: true
  progress_reporting_interval: 300s  # 5åˆ†é’Ÿ
  agent_health_checks: true
  automatic_failover: true
  
  notifications:
    phase_completion: true
    error_alerts: true
    final_report: true
  
  logging:
    level: "detailed"
    include_performance_metrics: true
    include_token_usage: true
    include_model_switching_events: true

# é”™è¯¯å¤„ç†å’Œæ¢å¤
error_handling:
  retry_strategy: "exponential_backoff"
  max_retries_per_agent: 3
  failover_to_lower_model: true
  partial_execution_recovery: true
  checkpoint_system: true
  
  recovery_procedures:
    memory_corruption: "restore_from_checkpoint"
    agent_timeout: "restart_with_reduced_scope"
    model_overload: "switch_to_fallback_model"

# è´¨é‡ä¿è¯
quality_gates:
  memory_system_validation:
    required_files_check: true
    content_quality_assessment: true
    cross_reference_validation: true
  
  implementation_validation:
    code_quality_check: true
    test_coverage_requirement: 80
    security_scan_required: true
  
  testing_validation:
    comprehensive_coverage_required: true
    performance_regression_check: true
    security_vulnerability_scan: true